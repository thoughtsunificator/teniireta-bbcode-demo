!function(){"use strict";class e{constructor(e){this._observable=e}get observable(){return this._observable}}class t{constructor(e,t,n){this._observable=e,this._eventName=t,this._callback=n}remove(){this._observable.removeListener(this)}get eventName(){return this._eventName}get callback(){return this._callback}}class n{constructor(){this._listeners={}}listen(e,n,o=!1){Array.isArray(this._listeners[e])||(this._listeners[e]=[]);const s=new t(this,e,n);return o?this._listeners[e].unshift(s):this._listeners[e].push(s),s}removeListener(e){this._listeners[e.eventName]=this._listeners[e.eventName].filter((t=>t!==e))}emit(e,t){if(Array.isArray(this._listeners[e]))for(const n of this._listeners[e])n.callback(t)}}class o{constructor(t,o=new e(new n)){this._identifier={},this._properties={...t},this._parent=null,this._root=null,this._model=null,this._children=[],this._listeners=[],this._eventListener=o}get identifier(){return this._identifier}get properties(){return this._properties}get root(){return this._root}get model(){return this._model}get eventListener(){return this._eventListener}listen(e,t,n,o=!1){const s=e.listen(t,n,o);return o?this._listeners.unshift(s):this._listeners.push(s),s}run(e,t){t.binding._parent=this,this._children.push(t.binding),t.binding._properties={...this.properties,...t.binding.properties},s.run(e,{parentNode:this.root,...t})}remove(){const e=this._listeners.slice();for(const t of e)t.remove();const t=this._children.slice();for(const e of t)e.remove();null!==this._parent&&(this._parent._children=this._parent._children.filter((e=>e!==this))),this.root.remove()}onCreated(){}async onRendered(){}}class s{static PROPERTIES=["tagName","children","identifier","model","binding","properties"];static METHOD={APPEND_CHILD:"APPEND_CHILD",INSERT_BEFORE:"INSERT_BEFORE",REPLACE_NODE:"REPLACE_NODE",WRAP_NODE:"WRAP_NODE",PREPEND:"PREPEND"};static run(e,{parentNode:t,binding:n=new o,method:i=s.METHOD.APPEND_CHILD}={}){const r=s.createNode(t,e,n);n._root=r,n._model=e;for(const e of Object.getOwnPropertyNames(Object.getPrototypeOf(n.eventListener)).filter((e=>"constructor"!==e&&"function"==typeof n.eventListener[e])))n.listen(n.eventListener.observable,e,n.eventListener[e].bind(n),!0);n.onCreated(),i===s.METHOD.APPEND_CHILD?t.appendChild(r):i===s.METHOD.INSERT_BEFORE?t.parentNode.insertBefore(r,t):i===s.METHOD.REPLACE_NODE?t.replaceWith(r):i===s.METHOD.WRAP_NODE?(r.appendChild(t.cloneNode(!0)),t.replaceWith(r)):i===s.METHOD.PREPEND&&t.prepend(r),n.onRendered()}static createNode(e,t,n){const{tagName:o,children:i=[]}=t,r=e.ownerDocument.createElement(o);Object.keys(t).filter((e=>!1===s.PROPERTIES.includes(e))).forEach((function(e){r[e]=t[e]}));for(const t of i)if(!0===Object.prototype.hasOwnProperty.call(t,"model")){let e;!0===Object.prototype.hasOwnProperty.call(t,"binding")&&(e=new t.binding({...n.properties,...t.properties}),!0===Object.prototype.hasOwnProperty.call(t,"identifier")&&(n.identifier[t.identifier]=e)),n.run(t.model,{parentNode:r,binding:e})}else{const o=s.createNode(e,t,n);r.appendChild(o)}return!0===Object.prototype.hasOwnProperty.call(t,"identifier")&&(n.identifier[t.identifier]=r),r}}var i={tagName:"div",className:"teniireta"},r={tagName:"iframe",style:"border-width: 0; width: 100%"},a={tagName:"div",className:"status_bar",children:[{tagName:"div",textContent:"Mode:"},{tagName:"div",children:[{tagName:"label",children:[{tagName:"input",type:"radio",name:"mode",checked:!0,identifier:"html"},{tagName:"span",textContent:"HTML"}]}]},{tagName:"div",children:[{tagName:"label",children:[{tagName:"input",type:"radio",name:"mode",identifier:"raw"},{tagName:"span",textContent:"Raw"}]}]}]},d={tagName:"body",contentEditable:!0,style:"background-color: white"};class c extends o{onCreated(){const{editor:e,template:t}=this.properties;e.listen("mode set html",(()=>{this.root.innerHTML=t.toHTML(this.root.textContent)})),e.listen("mode set raw",(()=>{this.root.textContent=t.toRaw(this.root.innerHTML)})),e.listen("raw set",(n=>{const o=t.toHTML(n);this.root.innerHTML=o,e.emit("indicators refresh"),e.emit("input changed",{html:o,raw:n})})),this.root.addEventListener("focus",(t=>{e.emit("focused",t)})),this.root.ownerDocument.addEventListener("selectionchange",(t=>{e.emit("selection changed",{event:t,selection:this.root.ownerDocument.getSelection()})})),this.root.addEventListener("input",(()=>{e.emit("input changed",{html:t.toHTML(this.root.textContent),raw:t.toRaw(this.root.innerHTML)})})),this.root.addEventListener("keypress",(e=>{if(13===e.keyCode){e.preventDefault();const t=this.root.ownerDocument.getSelection().getRangeAt(0),n=document.createTextNode("\n");t.insertNode(n),t.setStartAfter(n)}}))}}class l extends o{onCreated(){const{editor:e,template:t,inputStylesheetURL:n}=this.properties;this.root.addEventListener("load",(()=>{if(null!==n){const e=document.createElement("link");e.href=n,e.type="text/css",e.rel="stylesheet",this.root.contentDocument.head.appendChild(e)}this.run(d,{method:s.METHOD.REPLACE_NODE,binding:new c,parentNode:this.root.contentDocument.body}),e.emit("initialized")}))}}class u extends o{onCreated(){const{editor:e}=this.properties;this.identifier.html.addEventListener("change",(()=>{e.emit("mode set html")})),this.identifier.raw.addEventListener("change",(()=>{e.emit("mode set raw")}))}}class h extends o{onCreated(){this.properties,this.run(r,{binding:new l,parentNode:this.root}),this.run(a,{binding:new u,parentNode:this.root})}}class m extends n{constructor(){super(),this._toolbar=null}get toolbar(){return this._toolbar}set toolbar(e){this._toolbar=e}}var p={tagName:"div",className:"teniireta-toolbar"};class N extends o{onCreated(){this.properties}}class g extends n{constructor(){super()}}class b{static tagName;static testNode(e){}static beforeCreateBBNode(e){}static createBBNode(e){}static beforeCreateNode(e){}static appendBBNode(e){e.parentMatch.bbNode.appendChild(e.bbNode)}static createNode(e){}static appendNode(e){e.parentMatch.node.appendChild(e.node)}}class f{constructor(e,t){this._bbDocument=e,this._document=t,this._nodeList=[],this._ignoreNodeList=[],this._matches=[],this._bbNode=null,this._code=null,this._parentMatch=null,this._node=null,this._tags=null}get document(){return this._document}get bbDocument(){return this._bbDocument}get nodeList(){return this._nodeList}get ignoreNodeList(){return this._ignoreNodeList}get matches(){return this._matches}get bbNode(){return this._currentBBNode}set bbNode(e){this._currentBBNode=e}get code(){return this._code}set code(e){this._code=e}get node(){return this._node}set node(e){this._node=e}get tags(){return this._tags}set tags(e){this._tags=e}}class _{static NAME={TEXT:"text",OPENING_TAG:"opening tag",CLOSING_TAG:"closing tag"};constructor(e,t,n){this._name=e,this._buffer=t,this._bufferIndex=n}get name(){return this._name}get buffer(){return this._buffer}get bufferIndex(){return this._bufferIndex}}class E extends _{constructor(e,t){super(_.NAME.TEXT,e,t)}}class x extends _{constructor(e,t,n,o=[]){super(e,t,n),this._keys=o}get keys(){return this._keys}}class y{constructor(e,t){this._name=e,this._value=t}get name(){return this._name}get value(){return this._value}}const C="abcdefghijklmnopqrstuvwxyz",w=[...C+"*"],T=[...C+"0123456789#:/."];class B{static ELEMENT_BBNODE=1;static TEXT_BBNODE=2;constructor(){this._ownerDocument=null,this._parentNode=null,this._previousSibling=null,this._nextSibling=null,this._textContent=""}get ownerDocument(){return this._ownerDocument}get parentNode(){return this._parentNode}get previousSibling(){return this._previousSibling}get nextSibling(){return this._nextSibling}get nodeType(){return this._nodeType}get textContent(){return this._textContent}set textContent(e){if(this.nodeType===B.ELEMENT_BBNODE){for(let e=0;e<this.childNodes.length;e++)this.removeChild(this.childNodes[e]),e--;const t=O(e).documentElement.childNodes[0];this.appendChild(t)}this._textContent=e}remove(){this.parentNode.removeChild(this)}cloneNode(e){let t;if(this.nodeType===B.ELEMENT_BBNODE){t=new L(this.tagName);for(const[e,n]of this.keys)t.setKey(e,n);t._keys=new Map(this.keys),e&&(t.innerBBCode=this.innerBBCode)}else t=new S(this.textContent);return t}}class v{constructor(e){this._currentNode=e,this._rootNode=e,this._path=[]}get currentNode(){return this._currentNode}parentNode(){return this._currentNode=this._currentNode.parentNode,this._currentNode}nextNode(){if(this.currentNode.nodeType===B.ELEMENT_BBNODE&&this.currentNode.childNodes.length>=1){const e=this.currentNode;this._currentNode=this.currentNode.childNodes[0],e!==this._rootNode&&this._path.push(e)}else if(null===this.currentNode.nextSibling||this._path.includes(this.currentNode.nextSibling)){this._currentNode=null;const e=this._path.slice();e.reverse();for(const t of e)if(null!==t.nextSibling&&!this._path.includes(t.nextSibling)){this._currentNode=t.nextSibling,this._path.push(t.nextSibling);break}}else this._path.push(this.currentNode.nextSibling),this._currentNode=this.currentNode.nextSibling;return this.currentNode}}class L extends B{constructor(e,t=null){super(),this._nodeType=B.ELEMENT_BBNODE,this._childNodes=[],this._tagName=e,this._keys=new Map([[e,t]]),this._innerBBCode="";const n=this.tags();this._outerBBCode=`${n.opening}${n.closing}`}get tagName(){return this._tagName}get childNodes(){return this._childNodes}get keys(){return this._keys}get innerBBCode(){return this._innerBBCode}set innerBBCode(e){for(let e=0;e<this.childNodes.length;e++)this.removeChild(this.childNodes[e]),e--;const t=O(e).documentElement.childNodes;for(const e of t)this.appendChild(e);this._innerBBCode=e}get outerBBCode(){return this._outerBBCode}setKey(e,t=null){this._keys.set(e,t);const n=this.tags();this._outerBBCode=`${n.opening}${n.closing}`}appendChild(e){if(this.childNodes.length>=1){const t=this.childNodes[this.childNodes.length-1];t._nextSibling=e,e._previousSibling=t}e._parentNode=this,this.childNodes.push(e),this.build()}removeChild(e){null!==e.previousSibling&&(e.previousSibling._nextSibling=e.nextSibling),null!==e.nextSibling&&(e.nextSibling._previousSibling=e.previousSibling),this.childNodes.splice(this.childNodes.indexOf(e),1),this.build()}build(){const e=[this];let t=this.parentNode;for(;null!==t;)e.push(t),t=t.parentNode;for(const t of e)t._textContent=D(t,{excludeBBCode:!0}),t._innerBBCode=D(t,{excludeBBCode:!1}),t._outerBBCode=D(t,{excludeRoot:!1})}tags(){const e={opening:"",closing:""};e.opening+="[";for(const[t,n]of this.keys)e.opening.length>=2&&(e.opening+=" "),e.opening+=t,null!==n&&(!0===n.includes(" ")?e.opening+='="'+n+'"':e.opening+="="+n);return e.opening+="]","*"!==this.tagName&&(e.closing="[/"+this.tagName+"]"),e}querySelector(e){const t=new v(this);let n=null;for(;t.nextNode();)if(t.currentNode.tagName===e){n=t.currentNode;break}return n}querySelectorAll(e){const t=new v(this);let n=[];for(;t.nextNode();)t.currentNode.tagName===e&&n.push(t.currentNode);return n}}class S extends B{constructor(e){super(),this._nodeType=B.TEXT_BBNODE,this._textContent=e}}class M{constructor(){this._documentElement=new L,this._documentElement._ownerDocument=this}get documentElement(){return this._documentElement}createTextNode(e){const t=new S(e);return t._ownerDocument=this,t}createElement(e,t){const n=new L(e,t);return n._ownerDocument=this,n}createTreeWalker(e){return new v(e)}}function D(e,{excludeBBCode:t=!1,excludeRoot:n=!0}={}){let o="";if(e.nodeType===B.ELEMENT_BBNODE){const s=e.tags();let i="";for(const n of e.childNodes)i+=D(n,{excludeBBCode:t,excludeRoot:!1});e.ownerDocument&&e.ownerDocument.documentElement===e||!1!==t||!1!==n?o+=i:o+=`${s.opening}${i}${s.closing}`}else o+=e.textContent;return o}function k(e){let t=function(e){const t=[...e];let n="";const o=[],s=[];for(const[e,i]of t.entries()){n+=i;const t=e-n.length+1;if(n[0]+n[1]==="[/"){if(2===n.length)continue;if(0===s.length)!0===w.includes(i.toLowerCase())?s.push(new y(i,null)):(o.push(new E(n,t)),n="");else if(s.length>=1){const e=s[s.length-1];!0===w.includes(i.toLowerCase())?e._name+=i:"]"===i?(o.push(new x(_.NAME.CLOSING_TAG,n,t,[...s])),s.splice(0,s.length),n=""):(o.push(new E(n,t)),s.splice(0,s.length),n="")}}else if("["===n[0]){if(1===n.length)continue;if(0===s.length)!0===w.includes(i.toLowerCase())?s.push(new y(i,null)):(o.push(new E(n,t)),n="");else if(s.length>=1){const e=s[s.length-1];if("string"==typeof e.value){if(0===e.value.length)!0===T.includes(i.toLowerCase())||"'"===i||'"'===i?e._value+=i:(o.push(new E(n,t)),n="",s.splice(0,s.length));else if(e.value.length>=1){const r=!("'"!==e.value[0]&&'"'!==e.value[0]||e.value[0]===e.value[e.value.length-1]&&1!==e.value.length);("'"===e.value[0]||'"'===e.value[0])&&!1===r&&e.value.length>1&&e.value[0]===e.value[e.value.length-1]&&(e._value=e.value.substring(1,e.value.length-1)),!0===T.includes(i.toLowerCase())||r?e._value+=i:"]"===i?(o.push(new x(_.NAME.OPENING_TAG,n,t,[...s])),s.splice(0,s.length),n=""):" "===i?s.push(new y("",null)):(o.push(new E(n,t)),n="",s.splice(0,s.length))}}else!0===w.includes(i.toLowerCase())?e._name+=i:"]"===i?(o.push(new x(_.NAME.OPENING_TAG,n,t,[...s])),s.splice(0,s.length),n=""):"="===i?e._value="":e.name.length>=1&&" "===i?s.push(new y("",null)):(o.push(new E(n,t)),n="",s.splice(0,s.length))}}else o.push(new E(n,t)),n=""}return o}(e),n=0,o=!1,s=[];t.filter((e=>e.name===_.NAME.OPENING_TAG||e.name===_.NAME.CLOSING_TAG)).forEach((function(e){e.name===_.NAME.OPENING_TAG&&"code"===e.keys[0].name?!0===o?(s.push(e),n++):o=!0:e.name===_.NAME.CLOSING_TAG&&"code"===e.keys[0].name?!0===o&&0===n?(s.forEach((function(e){e._name=_.NAME.TEXT})),o=!1,s=[]):(s.push(e),n>=1&&n--):!0===o&&s.push(e)}));const i=[],r=[];t.filter((e=>e.name===_.NAME.OPENING_TAG||e.name===_.NAME.CLOSING_TAG)).forEach((e=>{if(e.name===_.NAME.OPENING_TAG){if("*"===e.keys[0].name){const t=i.filter((e=>"*"===e.keys[0].name));t.length>=1&&(r.push({name:"bbcode",bufferIndex:t[t.length-1].bufferIndex,openingTag:t[t.length-1],closingTag:new x(_.NAME.CLOSING_TAG,e.buffer,e.bufferIndex,e.keys)}),i.splice(i.indexOf(t[t.length-1]),1))}i.push(e)}else if(e.name===_.NAME.CLOSING_TAG){if("list"===e.keys[0].name){const t=i.filter((e=>"*"===e.keys[0].name));t.length>=1&&(r.push({name:"bbcode",bufferIndex:t[t.length-1].bufferIndex,openingTag:t[t.length-1],closingTag:e}),i.splice(i.indexOf(t[t.length-1]),1))}const t=i.filter((t=>t.keys[0].name===e.keys[0].name));t.length>=1&&"*"!==e.keys[0].name?(i.splice(i.indexOf(t[t.length-1]),1),r.push({name:"bbcode",bufferIndex:t[t.length-1].bufferIndex,openingTag:t[t.length-1],closingTag:e})):e._name=_.NAME.TEXT}}));for(const e of i)e._name=_.NAME.TEXT;let a=null;for(let e=0;e<t.length;e++)t[e].name===_.NAME.TEXT?null===a?a=t[e]:(a._buffer+=t[e].buffer,t.splice(e,1),e--):a=null;return t=r.concat(t.filter((e=>e.name===_.NAME.TEXT))),t.sort(((e,t)=>e.bufferIndex-t.bufferIndex)),t}function O(e){let t=k(e);const n=new M;return t=t.map((e=>{if("bbcode"===e.name){const t=e.openingTag.keys,o=n.createElement(t[0].name,t[0].value);t.slice(1).forEach((e=>o.setKey(e.name,e.value))),e.bbNode=o}else e.name===_.NAME.TEXT&&(e.bbNode=n.createTextNode(e.buffer));return e})),t.forEach((e=>{const o=t.filter((t=>"bbcode"===t.name&&t!==e&&t.bufferIndex<e.bufferIndex&&e.bufferIndex<t.closingTag.bufferIndex));o.length>=1?o[o.length-1].bbNode.appendChild(e.bbNode):n.documentElement.appendChild(e.bbNode)})),n}var A=Object.freeze({__proto__:null,asterisk:class extends b{static tagName="*";static testNode(e){return"LI"===e.nodeName}static createBBNode(e){return e.bbDocument.createElement("*")}static createNode(e){return e.document.createElement("li")}},bold:class extends b{static tagName="b";static testNode(e){return"SPAN"===e.nodeName&&"bold"===e.style.fontWeight}static createBBNode(e){return e.bbDocument.createElement("b")}static createNode(e){const t=e.document.createElement("span");return t.style.fontWeight="bold",t}},center:class extends b{static tagName="center";static testNode(e){return"DIV"===e.nodeName&&"center"===e.getAttribute("align")}static createBBNode(e){return e.bbDocument.createElement("center")}static createNode(e){const t=e.document.createElement("div");return t.align="center",t}},code:class extends b{static tagName="code";static testNode(e){return"DIV"===e.nodeName&&"codetext"===e.className}static beforeCreateBBNode(e){e.ignoreNodeList.push(e.node.children[0]),e.node.children[0].childNodes.forEach((t=>e.node.appendChild(t)))}static createBBNode(e){return e.bbDocument.createElement("code")}static createNode(e){const t=e.document.createElement("div");t.className="codetext";const n=e.document.createElement("pre");return t.appendChild(n),t}static appendNode(e){"codetext"===e.parentMatch.node.className&&e.parentMatch.node.querySelector("pre").appendChild(e.node)}},color:class extends b{static tagName="color";static testNode(e){return"SPAN"===e.nodeName&&""!==e.style.color}static createBBNode(e){let t=null;if("rgb("===e.node.style.color.slice(0,4)){const n=e.node.style.color.slice(4,-1).split(",");t=`#${`${Number(n[0]).toString(16)}`.padStart(2,"0")}${`${Number(n[1]).toString(16)}`.padStart(2,"0")}${`${Number(n[2]).toString(16)}`.padStart(2,"0")}`.toUpperCase()}else t=e.node.style.color;return e.bbDocument.createElement("color",t)}static createNode(e){const t=e.document.createElement("span");return t.style.color=e.bbNode.keys.get("color"),t}},italic:class extends b{static tagName="i";static testNode(e){return"SPAN"===e.nodeName&&"italic"===e.style.fontStyle}static createBBNode(e){return e.bbDocument.createElement("i")}static createNode(e){const t=e.document.createElement("span");return t.style.fontStyle="italic",t}},image:class extends b{static tagName="img";static testNode(e){return"IMG"===e.nodeName}static createBBNode(e){const t=e.bbDocument.createElement("img");return t.textContent=e.node.getAttribute("src"),t}static createNode(e){const t=e.document.createElement("img");return t.className="userimg",e.bbNode.childNodes.length>=1?t.src=e.bbNode.textContent:t.src=e.bbNode.keys.get("img"),e.bbNode.keys.has("align")&&("left"===e.bbNode.keys.get("align")?t.className="userimg img-a-l":"right"===e.bbNode.keys.get("align")&&(t.className="userimg img-a-r")),t}},list:class extends b{static tagName="list";static testNode(e){return"UL"===e.nodeName||"OL"===e.nodeName}static createBBNode(e){let t=null;"OL"===e.node.nodeName&&(t="1");return e.bbDocument.createElement("list",t)}static createNode(e){let t;return t="1"===e.bbNode.keys.get("list")?e.document.createElement("ol"):e.document.createElement("ul"),t}},quote:class extends b{static tagName="quote";static testNode(e){return"DIV"===e.nodeName&&"quotetext"===e.className}static beforeCreateBBNode(e){"spoiler_content"===e.node.parentNode.className&&e.node.parentNode.parentNode.parentNode.appendChild(e.node),e.node.children.length>=1&&"STRONG"===e.node.children[0].nodeName&&(e.ignoreNodeList.push(e.node.children[0]),e.ignoreNodeList.push(e.node.children[0].firstChild),e.ignoreNodeList.push(e.node.children[1]),e.ignoreNodeList.push(e.node.querySelector(".hide_button")),e.ignoreNodeList.push(e.node.querySelector(".hide_button input")),e.ignoreNodeList.push(e.node.querySelector(".hide_button .spoiler_content")))}static createBBNode(e){let t=null;e.node.children.length>=1&&"STRONG"===e.node.children[0].nodeName&&(t=e.node.children[0].textContent.substring(0,e.node.children[0].textContent.length-" said:".length));return e.bbDocument.createElement("quote",t)}static createNode(e){const t=e.document.createElement("div");if(t.className="quotetext",null!==e.bbNode.keys.get("quote")){const n=e.document.createElement("strong");n.textContent=e.bbNode.keys.get("quote")+" said:",t.appendChild(n);const o=e.document.createElement("br");t.appendChild(o)}let n=e.bbNode.ownerDocument.createTreeWalker(e.bbNode);const o=[];for(;n.parentNode();)o.push(n.currentNode);const s=o.filter((e=>"quote"===e.tagName));n=e.bbNode.ownerDocument.createTreeWalker(e.bbNode);const i=[];for(;n.nextNode();)i.push(n.currentNode);const r=i.filter((e=>"quote"===e.tagName));if(1===s.length&&r.length>=1){const n=e.document.createElement("div");n.className="hide_button";const o=e.document.createElement("input");o.type="button",o.className="button expand_quote",o.setAttribute("onclick",'this.nextSibling.style.display = "block";this.remove();'),o.value="Expand Quote",n.appendChild(o);const s=e.document.createElement("span");s.className="spoiler_content",s.style.display="none",t.appendChild(n),n.appendChild(s)}return t}static appendNode(e){if("quotetext"===e.parentMatch.node.className){const t=e.bbDocument.createTreeWalker(e.bbNode),n=[];for(;t.parentNode();)n.push(t.currentNode);const o=n.filter((e=>"quote"===e.tagName));if("quotetext"===e.node.className&&2===o.length)e.matches.find((e=>e.bbNode===o[1])).node.querySelector(".spoiler_content").appendChild(e.node);else{const t=[...e.parentMatch.node.children].find((e=>"hide_button"===e.className));t?t.before(e.node):e.parentMatch.node.appendChild(e.node)}}}},right:class extends b{static tagName="right";static testNode(e){return"DIV"===e.nodeName&&"right"===e.getAttribute("align")}static createBBNode(e){return e.bbDocument.createElement("right")}static createNode(e){const t=e.document.createElement("div");return t.align="right",t}},strike:class extends b{static tagName="s";static testNode(e){return"SPAN"===e.nodeName&&"line-through"===e.style.textDecoration}static createBBNode(e){return e.bbDocument.createElement("s")}static createNode(e){const t=e.document.createElement("span");return t.style.textDecoration="line-through",t}},size:class extends b{static tagName="size";static testNode(e){return"SPAN"===e.nodeName&&""!==e.style.fontSize}static createBBNode(e){return e.bbDocument.createElement("size",e.node.style.fontSize.substring(0,e.node.style.fontSize.length-1))}static createNode(e){const t=e.document.createElement("span");return t.style.fontSize=e.bbNode.keys.get("size")+"%",t}},spoiler:class extends b{static tagName="spoiler";static testNode(e){return"DIV"===e.nodeName&&"hide_button"===e.className&&2===e.children.length&&"INPUT"===e.children[0].nodeName&&"button show_button"===e.children[0].className&&"SPAN"===e.children[1].nodeName&&"spoiler_content"===e.children[1].className}static beforeCreateBBNode(e){"spoiler_content"===e.node.parentNode.className&&e.node.parentNode.parentNode.appendChild(e.node);const t=e.node.children[0];t.nextElementSibling.childNodes.forEach((t=>e.node.appendChild(t))),e.ignoreNodeList.push(t),e.ignoreNodeList.push(t.nextElementSibling)}static createBBNode(e){let t=null,n=e.node.children[0].value.substring("show ".length);"spoiler"!==n&&(t=n);return e.bbDocument.createElement("spoiler",t)}static createNode(e){const t=e.document.createElement("div");t.className="hide_button";const n=e.document.createElement("input");n.type="button",n.className="button show_button",n.setAttribute("onclick",'const isHidden=this.nextElementSibling.style.display === "none";this.value=isHidden === true  ? this.value.replace("Show", "Hide") : this.value.replace("Hide", "Show");this.nextElementSibling.style.display=isHidden === true ? "block" : "none";'),null!==e.bbNode.keys.get("spoiler")?n.value=`Show ${e.bbNode.keys.get("spoiler")}`:n.value="Show spoiler",t.appendChild(n);const o=e.document.createElement("span");return o.className="spoiler_content",o.style.display="none",t.appendChild(o),t}static appendNode(e){"hide_button"===e.parentMatch.node.className&&e.parentMatch.node.querySelector(".spoiler_content").appendChild(e.node)}},underline:class extends b{static tagName="u";static testNode(e){return"SPAN"===e.nodeName&&"underline"===e.style.textDecoration}static createBBNode(e){return e.bbDocument.createElement("u")}static createNode(e){const t=e.document.createElement("span");return t.style.textDecoration="underline",t}},url:class extends b{static tagName="url";static testNode(e){return"A"===e.nodeName}static createBBNode(e){return e.bbDocument.createElement("url",e.node.getAttribute("href"))}static createNode(e){const t=e.document.createElement("a");return t.href=e.bbNode.keys.get("url"),t.rel="nofollow noopener noreferrer",t.target="_blank",t}},youtube:class extends b{static tagName="yt";static testNode(e){return"IFRAME"===e.nodeName&&"movie youtube"===e.className&&e.src.startsWith("https://youtube.com/embed/")&&e.src.length>"https://youtube.com/embed/".length}static createBBNode(e){return e.bbDocument.createElement("yt")}static createNode(e){const t=e.document.createElement("iframe");return t.className="movie youtube",e.bbNode.childNodes.length>=1?t.src="https://youtube.com/embed/"+e.bbNode.textContent:t.src="https://youtube.com/embed/"+e.bbNode.keys.get("yt"),t.width="425",t.height="355",t.frameBorder="0",t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,t}}}),I={tagName:"div",id:"demo"},P={tagName:"div",id:"raw-preview",style:"overflow: auto;"};class R extends o{async onCreated(){const{template:e,editor:t}=this.properties;let n=!0;this.listen(t,"input changed",(e=>{n?this.root.textContent=e.raw:this.root.innerHTML=e.html})),this.listen(t,"mode set html",(()=>{n=!0,this.root.textContent=e.toRaw(this.root.innerHTML)})),this.listen(t,"mode set raw",(()=>{n=!1,this.root.innerHTML=e.toHTML(this.root.textContent)}))}}var H={tagName:"button",textContent:"bold",title:"Bold"},q={tagName:"button",textContent:"center",title:"Center"},G={tagName:"button",textContent:"code",title:"Code"},z={tagName:"button",textContent:"color",title:"Color"},W={tagName:"button",textContent:"italic",title:"Italic"},j={tagName:"button",textContent:"image",title:"Image"},$={tagName:"button",textContent:"list",title:"List"},F={tagName:"button",textContent:"quote",title:"Quote"},X={tagName:"button",textContent:"right",title:"Right"},Y={tagName:"button",textContent:"strike",title:"Strike"},U={tagName:"button",textContent:"size",title:"Size"},V={tagName:"button",textContent:"spoiler",title:"Spoiler"},K={tagName:"button",textContent:"underline",title:"Underline"},Q={tagName:"button",textContent:"url",title:"URL"},J={tagName:"button",textContent:"youtube",title:"YouTube"};class Z extends o{onCreated(){this.properties}}class ee extends o{onCreated(){this.properties}}class te extends o{onCreated(){this.properties}}class ne extends o{onCreated(){this.properties}}class oe extends o{onCreated(){this.properties}}class se extends o{onCreated(){this.properties}}class ie extends o{onCreated(){this.properties}}class re extends o{onCreated(){this.properties}}class ae extends o{onCreated(){this.properties}}class de extends o{onCreated(){this.properties}}class ce extends o{onCreated(){this.properties}}class le extends o{onCreated(){this.properties}}class ue extends o{onCreated(){this.properties}}class he extends o{onCreated(){this.properties}}class me extends o{onCreated(){this.properties}}class pe extends N{onCreated(){this.properties,this.run(H,{binding:new Z}),this.run(q,{binding:new ee}),this.run(G,{binding:new te}),this.run(z,{binding:new ne}),this.run(W,{binding:new oe}),this.run(j,{binding:new se}),this.run($,{binding:new ie}),this.run(F,{binding:new re}),this.run(X,{binding:new ae}),this.run(Y,{binding:new de}),this.run(U,{binding:new ce}),this.run(V,{binding:new le}),this.run(K,{binding:new ue}),this.run(Q,{binding:new he}),this.run(J,{binding:new me})}}class Ne extends o{onCreated(){const{editor:e,template:t}=this.properties;this.run(P,{binding:new R({editor:e,template:t})}),this.run(p,{binding:new pe({editor:e,toolbar:toolbar})}),this.run(i,{binding:new h({editor:e,inputStylesheetURL:"./resource/input.css",template:t})}),e.emit("raw set","\nHow to use BBcode\n\nBBcode is used to format text, insert url's and pictures in a post on the forums, profile, comments and in PM's. BBcode is similar to HTML. The only difference is BBcode uses square braces [] instead of <> in HTML. Written by Cheesebaron.\n\nText Formatting\n\n\tYou can change the style of the text the following ways:\n\t[b]bo-rudo[/b] - this makes the text bold\n\t[u]anda-rain[/u] - this underlines the text\n\t[i]itarikku[/i] - this italicises the text\n\t[s]sutoraiki[/s] - this strikes through the text\n\t[center]text[/center] - this centers the text\n\t[right]text[/right] - this right justifies the text\n\nChanging the text color and size\n\n\t[color=blue]buru[/color] - this changes the text color to blue\n\n\tYou can also use colour codes to define what colour you want your text to be\n\t[color=#FFFFFF]Shiroi[/color] - this changes the text color to white\n\n\tYou can change the text size by using the [size=][/size] tag, the size is dependant on what value written. You can choose 20 to 200, which is representing the size in percent.\n\n\t\t[size=30]KOMAKAI[/size] - will give a very small text size [size=200]KOUDAI[/size] - will give a huge text size\n\nPosting a YouTube Video\n\n\t[yt]_YL7t_QbQ2M[/yt]\n\n\tPosts a YouTube video.\n\nCreating lists\n\n\tYou can create a list by using the [code][list][/list][/code] tag.\n\n\tTo create an un-ordered list:\n\n\t\t[list]\n\t\t[*]kawaii\n\t\t[*]fugu\n\t\t[*]shouen\n\t\t[/list]\n\n\n\tTo create an ordered, numbered list:\n\n\n\t[list=1]\n\t[*]kawaii\n\t[*]fugu\n\t[*]shouen\n\t[/list]\n\n\tNested list:\n\n\t\t[list][*]Level 1.[*]Level 1.\n\t[list][*]Level 2.[*]Level 2.\n\t[list][*]Level 3.[*]Level 3.\n\t[list][*]Level 4.[*]Level 4.\n\t[list=1][*]Numbered list.[*]Numbered list.\n\t[/list][/list][/list][/list][/list]\n\n\nCreating links and showing images\n\n\t[url=https://myanimelist.net]Visit MyAnimeList[/url] - this would display Visit MyAnimeList as an URL.\n\n\tTo insert a picture to your post you can use the [code][img][/img][/code] tag.\n\n\t\t[img]./resource/image.jpg[/img]\n\n\tTo insert a left/right aligned picture you can use the [code][img align=(left or right)][/img][/code].\n\n\t\t[img align=left]./resource/image.jpg[/img]\n\t\t[img align=right]./resource/image.jpg[/img]\n\nMaking a spoiler button\n\n\tTo make a spoiler button use the [spoiler][/spoiler] tag, and the text in between the tags become invisible until the \"Show spoiler\" button is clicked.\n\n\t\t[spoiler]This is a spoiler for an episode of an anime that could make people angry[/spoiler]\n\n\tTo make a named spoiler button you can use the [code][spoiler=name][/spoiler][/code].\n\n\t\t[spoiler=secret]Secret[/spoiler]\n\t\t[spoiler=\"big secret\"]Big Secret[/spoiler]\n\t\t[spoiler='big secret']Big Secret[/spoiler]\n\t\t[spoiler='nested spoiler'][spoiler][spoiler][spoiler][spoiler]Secret[/spoiler][/spoiler][/spoiler][/spoiler][/spoiler]\n\nWriting raw text\n\n\tTo write raw text use the [code][/code] tag.\n\n\t\t[code]You can make the text bold with [code][b][b][b]text[/b][/b][/b][/code][code][b][/b][/code]tag.[/code]\n\nCombining BBcode\n\n\tYou can combine BBcodes, but you have to remember to end the tags in the right order\n\tThis example is WRONG:\n\t[code][url=https://myanimelist.net][img]https://myanimelist.net/picture.jpg[/url][/img][/code]\n\tThis example is RIGHT:\n\t[code][url=https://myanimelist.net][img]https://myanimelist.net/picture.jpg[/img][/url][/code]\n\nQuotes\n\n[quote]Some text[/quote]\n\n[quote=nickname]Some text[/quote]\n\n[quote=nickname]Some text[quote=nickname]Some text[quote=nickname]Some text[quote=nickname]Some text[quote=\"nickname\"]Some text[/quote][/quote][/quote][/quote][/quote]\n\n\n\nUser Mention\n\n\tTo mention another user on the forum add an @ symbol before their name. For example @user_name\n")}}const ge=new class extends class{constructor(e,t){this._codes=e,this._document=t}get codes(){return this._codes}get document(){return this._document}toHTML(e){const t=O(e),n=new f(t,this.document),o=t.createTreeWalker(t.documentElement);for(;o.nextNode();)n.nodeList.push(o.currentNode);const s=this.document.createElement("div");for(const e of n.nodeList){if(n.bbNode=e,n.tags=null,n.code=null,n.node=null,n.parentMatch=null,-1!==n.ignoreNodeList.indexOf(e))continue;if(e.nodeType===B.ELEMENT_BBNODE){n.tags=e.tags();const o=this.codes.find((t=>t.tagName===e.tagName));if(o)n.code=o,n.code.beforeCreateNode(n),n.node=n.code.createNode(n);else{const o=t.createTreeWalker(e);for(;o.nextNode();)n.ignoreNodeList.push(o.currentNode);n.node=this.document.createTextNode(e.outerHTML)}}else n.node=this.document.createTextNode(e.textContent);const o=n.matches.find((t=>t.bbNode===e.parentNode));if(o){n.parentMatch=o;const e=this.codes.find((e=>e.tagName===o.bbNode.tagName));e?e.appendNode(n):n.parentMatch.node.appendChild(n.node)}else s.appendChild(n.node);n.node.nodeType===this.document.ELEMENT_NODE&&n.matches.push({bbNode:e,node:n.node})}return s.innerHTML}toBBCode(e){const t=new M,n=new f(t,this.document),o=this.document.createElement("div");o.innerHTML=e;const s=this.document.createTreeWalker(o);for(;s.nextNode();)n.nodeList.push(s.currentNode);for(const e of n.nodeList){if(n.node=e,n.code=null,n.bbNode=null,n.tags=null,n.parentMatch=null,-1!==n.ignoreNodeList.indexOf(e))continue;if(e.nodeType===this.document.ELEMENT_NODE){const o=this.codes.find((t=>!0===t.testNode(e)));if(o)n.code=o,n.code.beforeCreateBBNode(n),n.bbNode=n.code.createBBNode(n),n.tags=n.bbNode.tags();else{const o=this.document.createTreeWalker(e);for(;o.nextNode();)n.ignoreNodeList.push(o.currentNode);n.bbNode=t.createTextNode(e.outerHTML)}}else e.nodeType===this.document.TEXT_NODE&&(n.bbNode=t.createTextNode(e.textContent));const o=n.matches.find((t=>t.node===e.parentNode));if(o){n.parentMatch=o;const e=this.codes.find((e=>e.tagName===o.bbNode.tagName));e?e.appendBBNode(n):n.parentMatch.bbNode.appendChild(n.bbNode)}else t.documentElement.appendChild(n.bbNode);n.bbNode.nodeType===B.ELEMENT_BBNODE&&n.matches.push({bbNode:n.bbNode,node:e})}return t.documentElement.innerBBCode}}{toHTML(e){return super.toHTML(e)}toRaw(e){return super.toBBCode(e)}}(Object.values(A),document);window.addEventListener("load",(async function(){const e=new m;new g,s.run(I,{binding:new Ne({editor:e,template:ge}),parentNode:document.body})}))}();
